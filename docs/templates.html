<html><head><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><title>OVO Comms Platform</title><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="comms-platform" /><meta name="author" content="Comms team" /><meta name="og:image" content="/comms-platform/img/poster.png" /><meta name="og:title" content="OVO Comms Platform" /><meta name="og:site_name" content="OVO Comms Platform" /><meta name="og:url" content="https://ovoenergy.slack.com/messages/hello_comms/" /><meta name="og:type" content="website" /><meta name="og:description" content="comms-platform" /><meta name="twitter:image" content="/comms-platform/img/poster.png" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:site" content="" /><link rel="icon" type="image/png" href="/comms-platform/img/favicon.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/comms-platform/highlight/styles/default.css" /><link rel="stylesheet" href="/comms-platform/css/style.css" /><link rel="stylesheet" href="/comms-platform/css/palette.css" /><link rel="stylesheet" href="/comms-platform/css/docs.css" /><link rel="stylesheet" href="/comms-platform/css/home.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/comms-platform/" class="brand"><div class="brand-wrapper" style="background:url('/comms-platform/img/sidebar_brand.png') no-repeat"><span>OVO Comms Platform</span></div></a></li> <li><a href="/comms-platform/docs/index.html" class="">Getting Started</a></li> <li><a href="/comms-platform/docs/templates.html" class=" active ">Templates</a> <ul class="sub_section"> <li><a href="/comms-platform/docs/templates/email.html" class="">Email</a></li> <li><a href="/comms-platform/docs/templates/sms.html" class="">SMS</a></li> <li><a href="/comms-platform/docs/templates/print.html" class="">Print</a></li></ul></li> <li><a href="/comms-platform/docs/rest-api.html" class="">REST API</a></li> <li><a href="/comms-platform/docs/channels.html" class="">Channels</a></li> <li><a href="/comms-platform/docs/feedback.html" class="">Feedback</a></li> <li><a href="/comms-platform/docs/scheduling.html" class="">Scheduling</a></li> <li><a href="/comms-platform/docs/events.html" class="">Events</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li class="hidden-xs"><a href="https://github.com/ovotech/comms-platform"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li class="hidden-xs"><a href="https://github.com/ovotech/comms-platform"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('OVO Comms Platform comms-platform');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('OVO Comms Platform comms-platform');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="ovotech" data-github-repo="comms-platform"><div class="content-wrapper"><section><h1 id="templates">Templates</h1>

<p>In order to send comms, you will need a template.</p>

<h2 id="directory-structure">Directory structure</h2>

<p>A comm template is a directory on S3 that adheres to the following structure.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;comm-type&gt;/
  &lt;comm-name&gt;/
    &lt;version&gt;/
      email/
        subject.txt
        body.html
        body.txt (optional)
        sender.txt (optional)
        assets/ (optional)
      sms/
        body.txt
</code></pre></div></div>

<p>Let’s go through some of that terminology.</p>

<h3 id="template-id">template id</h3>
<p>A unique id for the template, generated at the time of publishing a new template. This id is required in the HTTP request to trigger a comm, find out more about the REST API <a href="rest-api.md">here</a>.</p>

<p>The template id is displayed under the template name in the <a href="https://templates.ovo-comms.co.uk">Template Manager App</a>. 
<img src="../img/templateId.png" alt="Template ID in Template Manager" /></p>

<h3 id="brand">brand</h3>
<p>Every template is assigned to a brand. The following brands are currently configured:</p>
<ul>
  <li>OVO</li>
  <li>Boost</li>
  <li>Lumo</li>
  <li>Corgi</li>
  <li>VNet</li>
</ul>

<p>This paves the way for future work to enable us to send SMS messages from the brand associated with the given comm, using an alphanumeric sender relevant to the specific brand. For more information on this please see the <a href="sms.html">SMS section</a>.</p>

<h3 id="comm-type">comm-type</h3>

<p>Comms are broadly categorised by their type. The main reason for doing this is so that different comms of the same type can share things like a common header and footer, in order to provide a consistent look and feel.</p>

<p>The currently supported categories are <code class="highlighter-rouge">Service</code>, <code class="highlighter-rouge">Regulatory</code> and <code class="highlighter-rouge">Marketing</code>.</p>

<h3 id="comm-name">comm-name</h3>

<p>It’s an arbitrary string that you get to decide.</p>

<h3 id="version">version</h3>

<p>Templates are versioned, and every published version of a comm is immutable. So if you want to make any changes to a comm template, you will need to publish a new version.</p>

<h3 id="channels">Channels</h3>

<p>Currently email, SMS and print channels are supported and you must provide either an email template, an SMS template, a print template or a combination of these three.</p>

<h2 id="handlebars-syntax">Handlebars syntax</h2>

<p>We support a subset of <a href="http://handlebarsjs.com/">Handlebars</a> syntax for templates.</p>

<p>As well as plain old Mustache-style placeholders (<code class="highlighter-rouge">{{foo}}</code>), you can also write conditionals using <code class="highlighter-rouge">{{#if foo}}</code>, and you can loop through lists of things using <code class="highlighter-rouge">{{#each things}}</code>.</p>

<h3 id="built-in-data">Built-in data</h3>

<p>The following fields are provided automatically for you to refer to in your templates:</p>

<ul>
  <li><code class="highlighter-rouge">profile.firstName</code> (only for customer comms)</li>
  <li><code class="highlighter-rouge">profile.lastName</code> (only for customer comms)</li>
  <li><code class="highlighter-rouge">recipient.emailAddress</code> (only available in email templates, not in other channels)</li>
  <li><code class="highlighter-rouge">recipient.phoneNumber</code> (only available in SMS templates, not in other channels)</li>
  <li><code class="highlighter-rouge">system.year</code></li>
  <li><code class="highlighter-rouge">system.month</code></li>
  <li><code class="highlighter-rouge">system.dayOfMonth</code></li>
</ul>

<p>We can add more of these fields if necessary. If you would like a new field added, please get in touch.</p>

<h4 id="customer-and-non-customer-comms">Customer and non-customer comms</h4>

<p>If you specify an OVO customer ID for the <code class="highlighter-rouge">deliverTo</code> field when you trigger your comm, we look up the customer’s profile and provide it for use in your template as the <code class="highlighter-rouge">profile.*</code> fields.</p>

<p>When you send a non-customer comm, by specifying contact details instead of a customer ID, we do not provide any <code class="highlighter-rouge">profile.*</code> fields.</p>

<h3 id="simple-example-template">Simple example template</h3>

<p>Here’s a hypothetical HTML email body template:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;p&gt;Hello {{profile.firstName}} {{profile.lastName}}!&lt;/p&gt;

&lt;p&gt;Thanks for doing that thing you just did. The result was: {{result}}.&lt;/p&gt;

&lt;p&gt;Here's another piece of data you might find useful: {{thing}}.&lt;p&gt;
</code></pre></div></div>

<p>In this case, <code class="highlighter-rouge">profile.firstName</code> and <code class="highlighter-rouge">profile.lastName</code> are provided automatically (assuming this is a customer comm), so you would need to provide the values of <code class="highlighter-rouge">result</code> and <code class="highlighter-rouge">thing</code> in your Kafka event when you trigger a comm. See the <a href="events.html">Events</a> page for more details of how this is done.</p>

<h3 id="more-complex-example">More complex example</h3>

<p>Here’s another hypothetical example that includes conditionals and loops:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;p&gt;Hello. Please give us your meter reads.&lt;/p&gt;

{{#if gas}}
  &lt;div&gt;
  We need reads for the following gas meters:

  &lt;ul&gt;
  {{#each gas.meters}}
    &lt;li&gt;{{this.meterNumber}}&lt;/li&gt;
  {{/each}}
  &lt;/ul&gt;

  &lt;/div&gt;
{{/if}}

{{#if electricity}}
  &lt;div&gt;
  We need reads for the following electricity meters:

  &lt;ul&gt;
  {{#each electricity.meters}}
    &lt;li&gt;{{this.firstNumber}} {{this.secondNumber}}&lt;/li&gt; 
  {{/each}}
  &lt;/ul&gt;

  &lt;/div&gt;
{{/if}}
</code></pre></div></div>

<h3 id="partials">Partials</h3>

<p>For emails we provide a common HTML email header and footer for use in comms of type <code class="highlighter-rouge">Service</code>.</p>

<p>You can include these in your Handlebars templates using the standard Handlebars partial syntax: <code class="highlighter-rouge">{{&gt; header }}</code> and <code class="highlighter-rouge">{{&gt; footer }}</code>.</p>

<h2 id="templates-app">Templates app</h2>

<p>The app for publishing and viewing templates is <a href="https://templates.ovo-comms.co.uk">here</a></p>

<h3 id="publishing-a-template">Publishing a template</h3>

<p>Whether you are publishing a new version of an existing template or a completely new template, via the app, you will be required to upload your template as a zip file.</p>

<p>Some example file structures for the zip file could be:</p>

<h4 id="email-only">Email only</h4>

<ul>
  <li><code class="highlighter-rouge">/email/subject.txt</code></li>
  <li><code class="highlighter-rouge">/email/body.html</code></li>
  <li><code class="highlighter-rouge">/email/body.txt</code></li>
  <li><code class="highlighter-rouge">/email/sender.txt</code></li>
  <li><code class="highlighter-rouge">/email/assets/images/someImage.png</code></li>
  <li><code class="highlighter-rouge">/email/assets/icon/someIcon.png</code></li>
</ul>

<h4 id="sms-only">SMS only</h4>

<ul>
  <li><code class="highlighter-rouge">/sms/body.txt</code></li>
</ul>

<h4 id="print-only">Print only</h4>
<ul>
  <li><code class="highlighter-rouge">/print/body.html</code></li>
  <li><code class="highlighter-rouge">/print/assets/images/someImage.png</code></li>
</ul>

<h4 id="email-and-sms">Email and SMS</h4>

<p>Could be as simple as:</p>

<ul>
  <li><code class="highlighter-rouge">/email/subject.txt</code></li>
  <li><code class="highlighter-rouge">/email/body.html</code></li>
  <li><code class="highlighter-rouge">/sms/body.txt</code></li>
</ul>

<h4 id="email-sms-and-print">Email, SMS and Print</h4>

<ul>
  <li><code class="highlighter-rouge">/email/subject.txt</code></li>
  <li><code class="highlighter-rouge">/email/body.html</code></li>
  <li><code class="highlighter-rouge">/sms/body.txt</code></li>
  <li><code class="highlighter-rouge">/print/body.html</code></li>
</ul>

<h2 id="environments">Environments</h2>

<p>Please note that both UAT and PRD use the same published templates, so you can test the same templates against UAT before using in PRD.</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/comms-platform/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script src="/comms-platform/js/main.js"></script></body></html>